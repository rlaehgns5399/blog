---
title: "[Linux/Ubuntu] User에 대한 명령어 공부"
date: 2019-03-12 20:25:28 -0400
categories: Linux/Ubuntu
---



특정 유저에게 특권 부여하기 : sudo



group은 그룹멤버들에게 같은 특권을 부여한다

:즉 유저에게 sudoers그룹을 부여함으로써 권한부여가능





/etc/sudoers는 권한을 정리한파일

```
#UserSpecificationSyntaxAccount Host=Command 
root ALL=(ALL:ALL) ALL
#user1 has root privilege while running “useradd”
user1 ALL=/user/sbin/useradd

#Members of group admin do not need a password 
%admin ALL=NOPASSWD: ALL
#Members of the sudo group may gain root privileges
%sudo ALL=(ALL:ALL) ALL
#Add users to group “admin” or “sudo” to make them sudoers.
```

> 위 단락은 유저에 대한 권한. 아래단락은 그룹에 대한 권한을 나타낸다.

```
%admin ALL=NOPASSWD: ALL
>  admin 그룹은 sudo커맨드를쓸때 비밀번호를 칠필요가없이 실행가능함을 의미한다.

user1 ALL=/user/sbin/useradd
> 모든 호스트에 대해서 useradd 명령어를 사용가능하다.

```



# Adding a user

useradd command 

– Parameters for adding a new user 

> 리눅스는 유저를 uid로 구분함, 즉 uid가 같은 2 아디가있으면 리눅스는 똑같이 취급함.
>
> shell은 취향임, 기본이 /bin/sh, 서버버전은 어차피 기본 shell밖에 없음.

- Username 
- -m : creating the user home directory (/home/[username]) 
- -g [default_group] : defining the group name of the user’s default login group 
- –G [supplementary_groups] : introducing a list of supplementary groups which the user is also a member; each group is separated by comma 
- –p [password] : defining the default password 
- -d [home_directory] : defining the home directory 
- –s [login_shell] : defining the path and filename of user’s default login shell 
- –o : allow non-unique UID



# Resource skeleton for a user

“/etc/skel” directory

> 유저를 만들때 사용할 기본 설정들이 들어있음. (유저의 스켈레톤이라고 생각)



# “adduser” command

> 더 쉽고 interactive함.
>
> default디렉토리 : 유저이름
>
> Adding user means : 단지 숫자와 유저이름을 매핑시키는것.

# usermod command

> 유저 정보 변경



로그인하면 > 리눅스는 userpw, shadow파일 두개보고 아이디 비번 체크해서 사용하게 허가.





userdel -f : 다른곳에서 사용하던 관계없이 유저 삭제.



# passed 명령어

shadow파일을 다룸





# Managing Groups

### groupadd : creates and adds a new group

- -g : gid 부여

### groupdel : 그룹 번호삭제, 유저와 매핑 삭제가 전부임



Group password : 그룹 비밀번호 설정

newgrp command : 그룹 권한 변환, 내가 시스템상에 그 그룹에 포함안됬는데, 이 프로그램 실행돈안 잠시 그 그룹인척 할수있음. 그룹 구성원으로 바껴서 뭔가 액션을 할 수 있음.

ex) 내가 다른그룹의 무언갈 사용할 필요가 있을때, 새 그룹 만들어서 그 파일에 대한 권한만 부여해놓고

그 그룹을 그 파일쓸때마다 가져와서 사용함.





유저 패스워드 입력 초기화

ctrl + U



# 7.

## (1) Take a screenshot 

![image-20190311120733296](/Users/dadadamarine/Desktop/etc/%E1%84%85%E1%85%B5%E1%84%82%E1%85%AE%E1%86%A8%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6/1-1.png)

## (2) Explain the reason of the result

it happens cause linux shell understand uppercase and lowercase differently

so 'echo' is command for ubuntu, but 'Echo' is not

# 8.

터미널이 종료됩니다.

# 9.

## (1) Take a screen shot 

![image-20190311121930140](/Users/dadadamarine/Desktop/etc/%E1%84%85%E1%85%B5%E1%84%82%E1%85%AE%E1%86%A8%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6/1-2.png)

## (2) Describe the meaning of the commands



#### (a) “useradd peterpan -m -s /bin/bash -G defender,neverland”

```
peterpan 유저를 설정하고, 설정파일에 정의된 경로를 홈디렉토리로 한다. bash를 기본 shell로 사용하고, 이 유저를 defender와, neverland그룹의 멤버로한다.
```



```
-m, --create-home
  Create the user's home directory if it does not exist. The files and directories contained in the skeleton directory (which can be defined with the -k option) will be copied to the home directory.
  By default, if this option is not specified and CREATE_HOME is not enabled, no home directories are created.

> 이 유저의 홈 디렉토리를 설정한다. 아무것도 입력하지 않으면 유저이름으로된 디렉토리를 생성하고, 홈디렉토리로 설정한다


-s, --shell SHELL
  The name of the user's login shell. The default is to leave this field blank, which causes the system to select the default login shell specified by the SHELL variable in /etc/default/useradd, or an empty string by default.
  
> 유저가 사용할 shell(:12)을 SHELL로 설정한다. 이 옵션을 사용하지 않을 경우 설정파일에 정의된 shell(:12)를 유저 쉘로 사용한다.

  
-G, --groups GROUP1[,GROUP2,...[,GROUPN]]]
  A list of supplementary groups which the user is also a member of. Each group is separated from the next by a comma, with no intervening whitespace. The groups are subject to the same restrictions as the group given with the -g option. The default is for the user to belong only to the initial group.

> 이 유저의 그룹을 지정한다.

  -b 이 위치 아래에 사용자 이름으로 된 홈디렉터리가 만들어집니다.
  -d 이 위치 아래에 사용자 데이터가 저장됩니다.
  -D 사용자를 새로 만드는 대신 useradd의 기본 설정을 바꿉니다.
  -e 계정 만료일을 지정합니다.
  -f 비밀번호 만료일을 지정합니다.
  -g 사용자가 속할 그룹(1개)를 지정합니다.
  -G 사용자가 속할 그룹(여러개)를 지정합니다.
  -h 도움말을 보여줍니다.
  -M 홈디렉터리를 만들지 않습니다.
  -s 사용자가 기본으로 사용할 쉘(bash 등)을 지정합니다.
  -u 사용자의 고유 숫자 ID를 지정합니다.
```



#### (b) usermod -a -G attacker hook

```
hook의 보조그룹에 attacker를 추가한다.
```



```
usermode : 사용자 계정 속성 변경
# usermod [옵션] [계정명]

옵션 
-a append : Add the user to the supplementary group(s). Use only with the -G option.
-c comment : 사용자 이름 또는 정보
-d home_directory : 사용자 계정 홈 디렉토리 지정
-e expire_date : 사용자 계정 만기일 지정
-f inactive_time : 비활성 기간, 사영자의 계정 유효일 지정
-g initial_group : 기본 그룹 지정
-G groups : 추가 그룹 변경(보조그룹)
-s shell : 로그인 시 사용할 기본 쉘 지정 
-u uid : 사용자 계정 uid 생성
 -m move-home : 홈디렉토리 변경시, 새 홈딩렉토리로 파일 이동(-d 옵션하고만 사용할 수 있음)
-l : 사용자명 변경
-L : 사용자의 패스워드에 Lock을 걸어 로그인 제한
```



## (3) Describe GID and members of new groups (defender, attacker and neverland), UID of new users (peterpan, hook)

GID 

defender : 1001

attacker : 1002

neverland: 1004

UID

peterpan : 1001

hook : 1002

# 10.



## (1) Take a screen shot

![image-20190311122849354](/Users/dadadamarine/Library/Application%20Support/typora-user-images/image-20190311122849354.png)

## (2) Explain the functionality of “su” and “whoami”

```
su : substitute user
현 사용자를 로그아웃하지 않고, 다른 사용자의 권한을 획득할 때 사용

whoami : 현재사용자출력
```

```
* su vs su -
su - : 로그인하고 새로운 환경변수가 적용된 새 셸을 여는것.
‘-’ -> ‘-l’ -> ‘--login’

Make the shell a login shell. This means the following. Unset all environment variables except TERM, HOME, and SHELL (which are set as described above), and USER and LOGNAME (which are set, even for the super-user, as described above), and set PATH to a compiled-in default value. Change to user's home directory. Prepend ‘-’ to the shell's name, intended to make it read its login startup file(s). 
```



## (3) Explain why three times of doing “exit” is required.

```
su 는 새 셸을 여는것이 아니라, 임시적으로 권한만 획득하는 명령어이다. 
현재 minseok -> peterman -> hook 로 임시 권한을 획득해서 쌓아갔으므로, root로 돌아가기위해선 3번의 exit이 필요하다.
```



# 11.

## Do “last” command, then take a screen shot 

![image-20190311132433987](/Users/dadadamarine/Library/Application%20Support/typora-user-images/image-20190311132433987.png)

# problem

### 1. Create a new user “wendy”. (Conditions : “Wendy” is included in two groups, “neverland” and “defender”. The home directory of “Wendy” will be “/home/wendy”, and the shell will be “/bin/bash”.)

##### (1) List the required commands sequentially, and describe their roles.

```
useradd wendy -m -d /home/wendy -s /bin/bash -G neverland,defender

> useradd wendy : wendy계정을 생성 

[option]
-m : /home/wendy 디렉토리 생성
-d : /home/wendy 를 홈디렉토리로 설정
-s /bin/bash : 기본 셸을 -s /bin/bash 로 설정
-G neverland,defender : neverland, defender그룹에 등록
```



##### (2) For validating the operations of the commands, print the contents of “/etc/passwd” file and “/etc/group” file by tail and take the screenshot.

![image-20190311144411941](/Users/dadadamarine/Library/Application%20Support/typora-user-images/image-20190311144411941.png)



### 2. Describe what is “/etc/login.defs” file, and list the important configuration parameters with simple explanation.

```
login.defs : 사용자 설정과 관련된 기본값을 정의한 파일

```

### login.defs 내용

![K-001](/Users/dadadamarine/Desktop/etc/%E1%84%85%E1%85%B5%E1%84%82%E1%85%AE%E1%86%A8%E1%84%89%E1%85%B3%20%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A6/K-001.png)

![image-20190311151025986](/Users/dadadamarine/Library/Application%20Support/typora-user-images/image-20190311151025986.png)

PASS_MAX_DAYS   //패스워드 사용이 가능한 기간 
PASS_MIN_DAYS    //패스워드 변경이 가능한 최소 기간 : 이만큼 지나야 변경가능
PASS_WARN_AGE  //패스워드 만료 표시 기간

UID_MIN, UID_MAX : UID의 범위



## 3.

#### (1) Create the following 3 users

- tester1 : UID = 2001, default-group = class1
- tester2 : UID = 2003, default-group = class1, other-groups = class2
- tester3 : UID = 2005, default-group = class2, other-groups = class1, class3
  To verify the results, print the contents of “/etc/passwd” file and “/etc/group” file by tail and take
  the screenshot.

![image-20190311153023706](/Users/dadadamarine/Library/Application%20Support/typora-user-images/image-20190311153023706.png)

(2) Then, set a group password for class2 as “13579”.
After then, switching user to “tester1” (su) and initiating a new session with class2 GID (newgrp).
To check the session run “id” command.
To verify the results, take the screenshot of this procedure. 

![image-20190311154949305](/Users/dadadamarine/Library/Application%20Support/typora-user-images/image-20190311154949305.png)

> 계정관련해서 권한때문에 root로 실행을 하였습니다. 계정 확인을 위해 맨아래 minseok계정 입력화면 추가하였습니다.





